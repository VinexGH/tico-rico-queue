<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tico Rico Queue - Personalizable</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap');

  :root {
    --color-bg: #f6e0d8;
    --color-primary: #b34242;
    --color-secondary: #4b2e2e;
    --color-light: #f0d6c4;
    --font-family: 'Comic Neue', cursive, 'Comic Sans MS', Arial, sans-serif;
  }

  body {
    margin: 0;
    background: var(--color-bg);
    font-family: var(--font-family);
    color: var(--color-secondary);
    transition: background 0.5s, color 0.5s;
  }

  h1 {
    text-align: center;
    margin: 1rem 0;
    font-size: 3rem;
    text-shadow: 2px 2px var(--color-primary);
  }

  #logo-container {
    display: flex;
    justify-content: center;
    margin-bottom: 0.8rem;
  }
  #logo-container img {
    max-height: 80px;
    border-radius: 15px;
    box-shadow: 2px 2px 8px rgba(0,0,0,0.3);
  }

  #container {
    display: flex;
    justify-content: center;
    gap: 1rem;
    padding: 0 1rem 2rem 1rem;
    flex-wrap: wrap;
  }

  .column {
    background: var(--color-primary);
    border-radius: 15px;
    flex: 1 1 320px;
    min-height: 450px;
    padding: 1rem;
    box-shadow: 5px 5px 15px rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    transition: background 0.5s;
  }

  .column h2 {
    color: var(--color-light);
    text-align: center;
    margin-bottom: 1rem;
    font-size: 2.3rem;
  }

  .order-list {
    flex-grow: 1;
    overflow-y: auto;
    padding-right: 0.5rem;
    scrollbar-width: thin;
    scrollbar-color: var(--color-secondary) var(--color-light);
  }
  .order-list::-webkit-scrollbar {
    width: 8px;
  }
  .order-list::-webkit-scrollbar-thumb {
    background-color: var(--color-secondary);
    border-radius: 10px;
  }

  .order {
    background: var(--color-light);
    margin-bottom: 0.75rem;
    padding: 0.75rem 1rem;
    border-radius: 10px;
    font-weight: 700;
    font-size: 1.4rem;
    box-shadow: 2px 2px 5px var(--color-primary);
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: transform 0.2s ease, box-shadow 0.3s ease;
    cursor: default;
  }
  .order:hover {
    transform: scale(1.03);
    box-shadow: 3px 3px 10px var(--color-secondary);
  }

  button {
    background: var(--color-secondary);
    color: var(--color-light);
    border: none;
    border-radius: 8px;
    padding: 0.4rem 0.8rem;
    cursor: pointer;
    font-weight: 700;
    font-size: 1rem;
    transition: background 0.3s;
  }
  button:hover {
    background: var(--color-primary);
  }

  #addOrderSection {
    text-align: center;
    margin-bottom: 1rem;
  }

  #newOrderName {
    padding: 0.5rem 1rem;
    font-size: 1.2rem;
    border-radius: 10px;
    border: 2px solid var(--color-primary);
    width: 220px;
  }

  #addOrderBtn {
    background: var(--color-secondary);
    color: var(--color-light);
    border: none;
    border-radius: 10px;
    padding: 0.5rem 1rem;
    margin-left: 0.5rem;
    cursor: pointer;
    font-weight: 700;
    font-size: 1.2rem;
    transition: background 0.3s;
  }
  #addOrderBtn:hover {
    background: var(--color-primary);
  }

  #settings {
    background: var(--color-primary);
    border-radius: 15px;
    padding: 1rem;
    margin: 0 auto 1.5rem auto;
    width: 320px;
    box-shadow: 3px 3px 12px rgba(0,0,0,0.2);
    color: var(--color-light);
    font-size: 1rem;
  }
  #settings label {
    display: block;
    margin-bottom: 0.4rem;
    font-weight: 700;
  }
  #settings input[type="color"],
  #settings select,
  #settings input[type="file"] {
    width: 100%;
    margin-bottom: 1rem;
    border-radius: 8px;
    border: none;
    padding: 0.3rem 0.6rem;
    font-size: 1rem;
    cursor: pointer;
  }

  /* Responsive para TV vertical */
  @media (max-width: 700px) {
    #container {
      flex-direction: column;
      gap: 1.2rem;
      padding-bottom: 4rem;
    }
    .column {
      min-height: 350px;
    }
  }
</style>
</head>
<body>

<h1>Tico Rico Queue</h1>

<div id="logo-container" title="Logo del negocio">
  <!-- Logo cargado aquí -->
</div>

<div id="settings">
  <label for="logoUpload">Sube tu logo (formato png/jpg):</label>
  <input type="file" id="logoUpload" accept="image/png, image/jpeg" />

  <label for="bgColor">Color de fondo:</label>
  <input type="color" id="bgColor" value="#f6e0d8" />

  <label for="primaryColor">Color principal (columnas):</label>
  <input type="color" id="primaryColor" value="#b34242" />

  <label for="secondaryColor">Color secundario (botones y texto):</label>
  <input type="color" id="secondaryColor" value="#4b2e2e" />

  <label for="fontFamily">Fuente:</label>
  <select id="fontFamily">
    <option value="'Comic Neue', cursive, 'Comic Sans MS', Arial, sans-serif" selected>Comic Nueva (cartoon)</option>
    <option value="'Arial Black', Gadget, sans-serif">Arial Black</option>
    <option value="'Verdana', Geneva, Tahoma, sans-serif">Verdana</option>
    <option value="'Courier New', Courier, monospace">Courier New</option>
  </select>
</div>

<div id="addOrderSection">
  <input type="text" id="newOrderName" placeholder="Nombre del pedido" />
  <button id="addOrderBtn">Agregar</button>
</div>

<div id="container">
  <div class="column" id="inProcess">
    <h2>En Proceso</h2>
    <div class="order-list" id="inProcessList"></div>
  </div>
  <div class="column" id="ready">
    <h2>Listos</h2>
    <div class="order-list" id="readyList"></div>
  </div>
</div>

<script>
  // Elementos DOM
  const inProcessList = document.getElementById('inProcessList');
  const readyList = document.getElementById('readyList');
  const addOrderBtn = document.getElementById('addOrderBtn');
  const newOrderName = document.getElementById('newOrderName');
  const logoContainer = document.getElementById('logo-container');

  const bgColorInput = document.getElementById('bgColor');
  const primaryColorInput = document.getElementById('primaryColor');
  const secondaryColorInput = document.getElementById('secondaryColor');
  const fontFamilySelect = document.getElementById('fontFamily');
  const logoUploadInput = document.getElementById('logoUpload');

  // Guardar y cargar configuración en localStorage
  const SETTINGS_KEY = 'ticoRicoQueueSettings';
  const ORDERS_KEY = 'ticoRicoQueueOrders';

  // Pedidos en memoria (array de objetos {id, name, state})
  let orders = [];

  // Genera ID único simple
  function generateId() {
    return 'id-' + Math.random().toString(36).substr(2, 9);
  }

  // Cargar configuración guardada o valores por defecto
  function loadSettings() {
    const saved = localStorage.getItem(SETTINGS_KEY);
    if(saved) {
      const config = JSON.parse(saved);
      document.documentElement.style.setProperty('--color-bg', config.bgColor);
      document.documentElement.style.setProperty('--color-primary', config.primaryColor);
      document.documentElement.style.setProperty('--color-secondary', config.secondaryColor);
      document.documentElement.style.setProperty('--color-light', lightenColor(config.primaryColor, 0.7));
      document.documentElement.style.setProperty('--font-family', config.fontFamily);
      bgColorInput.value = config.bgColor;
      primaryColorInput.value = config.primaryColor;
      secondaryColorInput.value = config.secondaryColor;
      fontFamilySelect.value = config.fontFamily;
      if(config.logoDataUrl) {
        setLogo(config.logoDataUrl);
      }
    }
  }

  // Guardar configuración actual
  function saveSettings() {
    const config = {
      bgColor: bgColorInput.value,
      primaryColor: primaryColorInput.value,
      secondaryColor: secondaryColorInput.value,
      fontFamily: fontFamilySelect.value,
      logoDataUrl: logoContainer.querySelector('img') ? logoContainer.querySelector('img').src : null
    };
    localStorage.setItem(SETTINGS_KEY, JSON.stringify(config));
  }

  // Color claro basado en primary para textos claros
  function lightenColor(color, luminosity = 0) {
    // Color en formato #rrggbb
    color = color.replace(/[^0-9a-f]/gi, '');
    if(color.length < 6) {
      color = color[0]+color[0]+color[1]+color[1]+color[2]+color[2];
    }
    let rgb = "#", c, i;
    for(i=0; i<3; i++) {
      c = parseInt(color.substr(i*2,2), 16);
      c = Math.min(255, Math.floor(c + (255 - c) * luminosity));
      rgb += ("00"+c.toString(16)).substr(-2);
    }
    return rgb;
  }

  // Actualiza los estilos CSS variables con los inputs actuales
  function applySettings() {
    document.documentElement.style.setProperty('--color-bg', bgColorInput.value);
    document.documentElement.style.setProperty('--color-primary', primaryColorInput.value);
    document.documentElement.style.setProperty('--color-secondary', secondaryColorInput.value);
    document.documentElement.style.setProperty('--color-light', lightenColor(primaryColorInput.value, 0.7));
    document.documentElement.style.setProperty('--font-family', fontFamilySelect.value);
    saveSettings();
  }

  // Cargar pedidos guardados
  function loadOrders() {
    const saved = localStorage.getItem(ORDERS_KEY);
    if(saved) {
      orders = JSON.parse(saved);
    } else {
      orders = [];
    }
  }

  // Guardar pedidos actuales
  function saveOrders() {
    localStorage.setItem(ORDERS_KEY, JSON.stringify(orders));
  }

  // Crear elemento visual para un pedido
  function createOrderElement(order) {
    const orderDiv = document.createElement('div');
    orderDiv.classList.add('order');
    orderDiv.dataset.id = order.id;

    const nameSpan = document.createElement('span');
    nameSpan.textContent = order.name;

    const btn = document.createElement('button');

    function updateButton() {
      if(order.state === 'inProcess') {
        btn.textContent = 'Listo';
      } else {
        btn.textContent = 'En Proceso';
      }
    }

    btn.addEventListener('click', () => {
      order.state = (order.state === 'inProcess') ? 'ready' : 'inProcess';
      renderOrders();
      saveOrders();
    });

    updateButton();

    orderDiv.appendChild(nameSpan);
    orderDiv.appendChild(btn);
    return orderDiv;
  }

  // Renderizar todas las listas
  function renderOrders() {
    inProcessList.innerHTML = '';
    readyList.innerHTML = '';
    orders.forEach(order => {
      const el = createOrderElement(order);
      if(order.state === 'inProcess') {
        inProcessList.appendChild(el);
      } else {
        readyList.appendChild(el);
      }
    });
  }

  // Añadir pedido nuevo
  addOrderBtn.addEventListener('click', () => {
    const name = newOrderName.value.trim();
    if(!name) return alert('Por favor, escribe un nombre para el pedido');
    const newOrder = {
      id: generateId(),
      name,
      state: 'inProcess'
    };
    orders.push(newOrder);
    newOrderName.value = '';
    newOrderName.focus();
    saveOrders();
    renderOrders();
  });

  // Cargar logo desde input file
  logoUploadInput.addEventListener('change', e => {
    const file = e.target.files[0];
    if(!file) return;
    if(!file.type.startsWith('image/')) {
      alert('Por favor sube un archivo de imagen válido.');
      return;
    }
    const reader = new FileReader();
    reader.onload = function(ev) {
      setLogo(ev.target.result);
      saveSettings();
    }
    reader.readAsDataURL(file);
  });

  // Setear logo en DOM
  function setLogo(dataUrl) {
    logoContainer.innerHTML = '';
    const img = document.createElement('img');
    img.src = dataUrl;
    img.alt = 'Logo del negocio';
    logoContainer.appendChild(img);
  }

  // Aplicar cambios al cambiar inputs
  [bgColorInput, primaryColorInput, secondaryColorInput, fontFamilySelect].forEach(input => {
    input.addEventListener('input', () => {
      applySettings();
    });
  });

  // Inicialización
  loadSettings();
  loadOrders();
  renderOrders();

  // Foco en input al cargar
  newOrderName.focus();
</script>

</body>
</html>
